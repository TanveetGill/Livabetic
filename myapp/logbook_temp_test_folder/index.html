<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.2/d3.min.js" charset="utf-8"></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/nvd3/1.8.3/nv.d3.min.js'></script>
    <link href='https://cdnjs.cloudflare.com/ajax/libs/nvd3/1.1.15-beta/nv.d3.min.css' rel='stylesheet'>

    <style>
        text {
            font: 12px sans-serif;
        }
        svg {
            display: block;
        }
        html, body, #test1, svg {
            margin: 0px;
            padding: 0px;
            height: 500px;
            width: 900px;
        }
    </style>
</head>
<body class='with-3d-shadow with-transitions'>

<div id="test1" class="chartWrap">
    <svg></svg>
</div>

<script>
    d3.csv("carelink.csv", function(error, data) {
        var myData = [
            {
                key: "Carbs",
                values: []
            }
        ];
        data.forEach(function(d) { 
            // console.log(d['BWZ Carb Input (grams)'])
            d['BWZ Carb Input (grams)'] = +d['BWZ Carb Input (grams)'];
            myData[0].values.push(d);

            // d.Date = new Date(moment(d.Date, 'DD/MM/YY').format('YYYY-MM-DD'));
        });          
        
        var chart;
        nv.addGraph(function() {
            chart = nv.models.scatterChart()
                .showDistX(true)
                .showDistY(true)
                .duration(300)
                .color(d3.scale.category10().range())
                .x(function (d) { return d.Date })
                .y(function (d) { return d['BWZ Carb Input (grams)'] });

            chart.dispatch.on('renderEnd', function(){
                console.log('render complete');
            });

            chart.xAxis.tickFormat(d3.format('.02f'));
            // chart.yAxis.tickFormat(d3.format(''));


            d3.select('#test1 svg')
                // .datum(nv.log(randomData(4,40)))
                .datum(myData)
                .call(chart);

            nv.utils.windowResize(chart.update);
            chart.dispatch.on('stateChange', function(e) { nv.log('New State:', JSON.stringify(e)); });
            return chart;
        });

    });

</script>
</body>
</html>